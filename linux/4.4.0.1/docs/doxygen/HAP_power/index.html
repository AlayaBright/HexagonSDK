<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>HAP_power APIs: Introduction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HAP_power APIs
   </div>
   <div id="projectbrief">DSP Power &amp; Performance Management</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Introduction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Hexagon SDK provides APIs to control DSP core and bus clocks based on power and performance needs. By default, every compute session votes for NOMINAL voltage corner and powers on HVX. Clients can choose to overwrite this by HAP power APIs below.</p>
<h1><a class="anchor" id="api"></a>
HAP_power API</h1>
<h2><a class="anchor" id="api-overview"></a>
API Overview</h2>
<p>HAP_power_* APIS are used by clients to override the power settings of the DSPs according to their needs. This API is supported on ADSP, CDSP and SLPI.</p>
<p>The HAP power API contains a set of interfaces that allow programmers to adjust the DSP power usage as per the application's power requirement, thereby providing a good balance between power consumption and performance.</p>
<ul>
<li><a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a>: This is used to vote for performance levels on the DSP</li>
<li><a class="el" href="group__HAP__power__functions.html#gaa28f7dbadaf78c378d874c29706530f9">HAP_power_get()</a>: This is used to query the DSP for current performance levels</li>
<li><a class="el" href="group__HAP__power__functions.html#gac6ce099d8d7093eaaff20d3bbc63e063" title="Method to destroy clients created through HAP_power_set, wrapper to HAP_power_destroy_client API...">HAP_power_destroy()</a>: This is used to destroy power clients created through HAP_power_set API</li>
</ul>
<p><a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a> can be used to control these parameters on the DSP:</p><ul>
<li>DSP MIPS</li>
<li>Bus speed / bandwidth</li>
<li>Dynamic scaling of bus and DSP clocks and bus speeds (DCVS)</li>
<li>Application type (client class), more details on this can be found <a href="#app-type">here</a></li>
<li>L2 cache line locking</li>
<li>Hexagon Vector eXtension (HVX) blocks</li>
</ul>
<p><a class="el" href="group__HAP__power__functions.html#gaa28f7dbadaf78c378d874c29706530f9">HAP_power_get</a> can be used to query the DSP for these parameters:</p><ul>
<li>Max MIPS supported</li>
<li>Max bus speed / bandwidth supported</li>
<li>Current Core clock speed</li>
<li>Current application type (client class)</li>
<li>Aggregate Mpps used by audio and voice</li>
</ul>
<p><a class="el" href="group__HAP__power__functions.html#gac6ce099d8d7093eaaff20d3bbc63e063" title="Method to destroy clients created through HAP_power_set, wrapper to HAP_power_destroy_client API...">HAP_power_destroy</a> can be used to destroy the power clients created through HAP_power_set API. Destroys any existing HAP_power votes associated with the provided client context, and disassociates that context from HAP_power.</p>
<h2><a class="anchor" id="usage"></a>
Usage</h2>
<p>See <a class="el" href="HAP__power_8h_source.html">HAP_power.h</a> for more information on this API.</p>
<p><a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a> : This accepts two parameters</p><ul>
<li>context - Unique identifier (explained below)</li>
<li>request - The power request.</li>
</ul>
<p>context is a unique identifier (in the scope of the PD) provided by the user to identify an independent voting client of HAP_power. For each unique context passed in a HAP_power_set invocation, HAP_power adds a new client to its state to be associated with that context.</p>
<p>On targets after Lahaina, helper APIs HAP_utils_create_context and HAP_utils_destroy_context are added to create and destroy unique context identifiers. If these are not available, the recommended alternative is to create a context by allocating a dummy byte and using the pointer value as the context, and freeing that byte later after destroying the context's associated HAP_power client via HAP_power_destroy.</p><ul>
<li><a class="el" href="group__HAP__power__functions.html#ga8396ca044ba67ba60e274602bc134ac0">HAP_utils_create_context()</a>: This is used to create a unique context identifier</li>
<li><a class="el" href="group__HAP__power__functions.html#gaa2404ca3cdc421747033b550e3372b6a">HAP_utils_destroy_context()</a>: This is used to destroy unique context identifier. HAP_utils_destroy_context should only be called on a context after destroying the HAP_power client associated to that context, via HAP_power_destroy(context). Failure to destroy both in the proper order may cause a leak.</li>
</ul>
<p>Refer to the following table for voting/unvoting call flow: </p><table class="doxtable">
<tr>
<th>Voting/Unvoting call flow</th><th>Library code </th></tr>
<tr>
<td>Create unique client context</td><td>context = userLibCodeToCreateUniqueContext() (or) context = <a class="el" href="group__HAP__power__functions.html#ga8396ca044ba67ba60e274602bc134ac0">HAP_utils_create_context()</a> </td></tr>
<tr>
<td>Create power client and vote</td><td>HAP_power_set(context, request) </td></tr>
<tr>
<td>Destroy power client</td><td>HAP_power_destroy(context) (or) HAP_power_destroy_client(context) </td></tr>
<tr>
<td>Destroy unique client context</td><td>userLibCodeToDestroyUniqueContext(context) (or) HAP_utils_destroy_context(context) </td></tr>
</table>
<p>NOTE: Using a context set to NULL has specific implications, discussed below in <a href="#default_voting">default voting</a></p>
<p>Example: Module1 and Module2 are two different clients running in the same user PD on DSP. Module1 creates a new, unique client context and votes for its needs. Module2 also creates a new, unique client context and votes for its needs. The figure below shows the different client contexts and their votes to power manager.</p>
<div class="image">
<img src="../../images/hap_power.png"  alt="screenshot"/>
</div>
<p>The type in the request is set to one of:</p><ul>
<li>HAP_power_set_mips_bw: Used to set MIPS and / or bus speed (bandwidth). The payload in this case should contain <a class="el" href="structHAP__power__mips__bw__payload.html">HAP_power_mips_bw_payload</a>.</li>
<li>HAP_power_set_HVX: Used to enable / disable power for HVX. The payload in this case should contain <a class="el" href="structHAP__power__hvx__payload.html">HAP_power_hvx_payload</a>.</li>
<li>HAP_power_set_apptype: Used to set the application type. The payload in this case should contain <a class="el" href="group__HAP__power__enums.html#gaf78f03a3417baa71707b45d8e78b65bd">HAP_power_app_type_payload</a>.</li>
<li>HAP_power_set_linelock: Used to line lock memory in the L2 cache. The payload in this case should contain <a class="el" href="structHAP__power__linelock__payload.html">HAP_power_linelock_payload</a>.</li>
<li>HAP_power_set_DCVS: Used to participate / stop participating in DCVS. The payload in this case should contain <a class="el" href="structHAP__power__dcvs__payload.html">HAP_power_dcvs_payload</a>.</li>
<li>HAP_power_set_DCVS_v2: Enhanced version of HAP_power_set_DCVS with more options. The payload in this case should contain <a class="el" href="structHAP__power__dcvs__v2__payload.html">HAP_power_dcvs_v2_payload</a>.</li>
<li>HAP_power_set_DCVS_v3: Enhanced version of HAP_power_set_DCVS_v2 with more options to select core and bus operating corners separately. The payload in this case should contain <a class="el" href="structHAP__power__dcvs__v3__payload.html">HAP_power_dcvs_v3_payload</a>.</li>
</ul>
<p>NOTE:</p><ul>
<li>More details on HAP_power_set_DCVS_v2 can be found <a href="#DCVS_V2">here</a>.</li>
<li>HAP_power_set_DCVS_v3 is supported from SM8250 onwards. More details can be found <a href="#DCVS_V3">here</a>.</li>
<li>In Older targets, maximum of 8 clients can be created per PD, (including the default client). This limitation has been removed from SM8250 onwards.</li>
</ul>
<p>Example is provided below.</p>
<div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a6f1ae78ec168c0e33fd0a8a5e3c59dde">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba0a2b18cb76401d0f85983539fad4047e">HAP_DCVS_V2_PERFORMANCE_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a3e0469413c326dafb1c9e990bb9df615">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a3089a1d2001b3ef318fbf129b7c6ced2">latency</a> = 1000;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a694bdd7bb3d0fb9f5a2bcffb319cdb6e">set_dcvs_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a8335d8b40c6b02ee20b364864aa8aeba">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a1ef0cba4efc2ed48d56e2fa5a60159fd">max_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a0778ad398c0b9a08762aa10970f19764">target_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* cv is a global variable or an address in heap to uniquely identify the clients */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(&amp;cv, &amp;request);</div><div class="line">...</div></div><!-- fragment --><p> <a class="el" href="group__HAP__power__functions.html#gaa28f7dbadaf78c378d874c29706530f9">HAP_power_get</a> : This accepts two parameters</p>
<ul>
<li>context - this parameter is ignored and response is for the system level</li>
<li>response - The power response</li>
</ul>
<p>The type in the request is set to one of</p><ul>
<li>HAP_power_get_max_mips: Used to query for maximum MIPS supported</li>
<li>HAP_power_get_max_bus_bw: Used to query for maximum bus bandwidth supported</li>
<li>HAP_power_get_client_class: Used to query for current application type.</li>
<li>HAP_power_get_clk_Freq: Used to query for current core clock frequency.</li>
<li>HAP_power_get_aggregateAVSMpps: Used to query for aggregate Mpps used by audio and voice.</li>
</ul>
<p><a class="el" href="group__HAP__power__functions.html#gac6ce099d8d7093eaaff20d3bbc63e063" title="Method to destroy clients created through HAP_power_set, wrapper to HAP_power_destroy_client API...">HAP_power_destroy</a> : This accepts one parameter</p>
<ul>
<li>context - the unique client context identifying the HAP_power client to destroy.</li>
</ul>
<p>Example to remove default vote for a PD and to destroy default client. </p><div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"><span class="keywordtype">int</span> nErr= 0;</div><div class="line"></div><div class="line"><span class="keywordflow">if</span>(0 == (nErr = <a class="code" href="group__HAP__power__functions.html#gac6ce099d8d7093eaaff20d3bbc63e063">HAP_power_destroy</a>(NULL))){</div><div class="line">   <span class="comment">//Client destroyed successfully</span></div><div class="line">}</div></div><!-- fragment --><h3><a class="anchor" id="default_voting"></a>
Default voting</h3>
<p>In older targets, NULL is a valid HAP_power context that is used by FastRPC to establish a default vote for some reasonable clock settings. In order to override the default vote on these targets, it is necessary for a client to place a canceling vote using the NULL context.</p>
<p>Permitting clients to use NULL context can lead to conflicts where multiple clients in the same PD may try to independently manage the NULL context. To address these conflicts, support for any NULL context voting has been removed starting in targets after Lahaina. For these targets, behavior of default voting has been changed. A suitable vote is placed automatically at opportune times (such as startup or object loading) on a unique context, and is automatically removed when no longer needed. For example, the FastRPC driver places a high clock vote when a new session is started on the DSP, and removes it as soon as any user in that session places any other HAP_power vote. This ensures clocks are high during startup and object loading, up until the point the user application is able to place its own vote.</p>
<p>The recommended client behavior is as follows:</p>
<ul>
<li>Lahaina and older targets: While it is allowed to rely on the default vote to establish reasonable clocks, it is recommended to place a canceling vote (with low/zero clock values as shown below) on the NULL context, plus an active vote for the requirements on a different unique context.</li>
<li>Targets after Lahaina: Simply place an active vote for required clock settings on a unique context.</li>
</ul>
<p>If a single client implementation is required to work correctly on all targets, the recommendation is as follows:</p><ul>
<li>Make an attempt to place a canceling NULL-context vote. If the error code AEE_ENULLCONTEXT is returned, it means the target does not support NULL context. Thus, this error can be ignored.</li>
<li>Place a (non-NULL) unique context vote for the clock requirements.</li>
</ul>
<p>On targets that support NULL context default voting, it can be removed using HAP_power_destroy(NULL) or as follows:</p>
<div class="fragment"><div class="line">req.type = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">req.dcvs_v2.dcvs_enable = FALSE;</div><div class="line">req.dcvs_v2.set_latency = FALSE;</div><div class="line">req.dcvs_v2.set_dcvs_params = FALSE;</div><div class="line">VERIFY(AEE_SUCCESS == (nErr = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(NULL, &amp;req)));</div></div><!-- fragment --><h3><a class="anchor" id="app-type"></a>
Application type/Client class</h3>
<p><a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a> API exposes an API for users to register for an application type.</p>
<p>'apptype' in <a class="el" href="structHAP__power__request__t.html">HAP_power_request_t</a> passed as parameter to HAP_power_set request allows user to register an application as one of the client classes available in <a class="el" href="group__HAP__power__enums.html#gaf78f03a3417baa71707b45d8e78b65bd">HAP_power_app_type_payload</a>. Setting an appropriate client class can be important as this information is used in DSP DCVS, QoS, DSP power management drivers. HAP_power clients who do not explicitly vote their apptype are treated as general compute applications, which is appropriate for most cases.</p>
<h4>Users of Client class information</h4>
<p>DCVS selects HAP_DCVS_V2_POWER_SAVER_MODE as default DCVS policy for COMPUTE and STREAMING class clients. Client can always power their own DCVS policy by issuing a DCVS_v2 request, click <a href="#DCVS_V2">here</a> for more details on DCVS_v2 request type of HAP_power_set. QoS driver modifies L2 scoreboard thresholds on detecting STREAMING class clients to allow DSP L2 slave accesses.</p>
<h3><a class="anchor" id="DCVS_V2"></a>
DSP DCVS v2 HAP interface</h3>
<p>Based on user configuration, DCVS module in DSP (ADSP/CDSP) can adjust the core and bus clock frequencies based on core and bus usage metrics captured by SysMon. The existing DCVS interface via <a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a> (type: HAP_power_set_DCVS) only allows users to vote for DCVS participation with 2 different options. DSP DCVS v2 algorithm exposes an enhanced set of DCVS options for diversified clients and a simplified voltage corner based voting scheme. On supported targets (8998 and latest), these new DCVS options and voting scheme are exposed to clients via <a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a>(type: HAP_power_set_DCVS_v2).</p>
<h4>HAP API Support</h4>
<p>The HAP_power_set API is enhanced to support the new mode registrations with DSP DCVS logic. Following table illustrates the new type of request and the new dcvs_v2 request structure associated with it.</p>
<table class="doxtable">
<tr>
<th>API </th><td colspan="3">HAP_power_set (void* context, HAP_power_request_t* request) </td></tr>
<tr>
<th>context </th><td colspan="3">Explained <a href="#usage">here</a>. Votes across all contexts will be aggregated accordingly. </td></tr>
<tr>
<th rowspan="7">request </th><td>type </td><td>HAP_power_set_DCVS_v2 </td><td>This new request type allows user to request via the new dcvs_v2 request structure. </td></tr>
<tr>
<td rowspan="6">dcvs_v2 </td><td>dcvs_enable </td><td>DCVS participation flag </td></tr>
<tr>
<td>dcvs_option </td><td>These options instruct DCVS algorithm to use a pre-defined set of thresholds and operation logic based on the selected option. </td></tr>
<tr>
<td>set_latency </td><td>Latency vote validity flag. If FALSE then default sleep latency vote of 65535 micro seconds will be considered. </td></tr>
<tr>
<td>latency </td><td>Sleep latency vote in micro seconds. Valid when the set_latency flag is set to TRUE </td></tr>
<tr>
<td>set_dcvs_params </td><td>DCVS params validity flag. If FALSE then all parameters of dcvs_params will be set to default zero. </td></tr>
<tr>
<td>dcvs_params </td><td>DCVS params structure with flexibility to set upper and lower DCVS thresholds and also vote for core and bus clocks using a voltage corner. </td></tr>
</table>
<h3><a class="anchor" id="DCVS_V3"></a>
DSP DCVS v3 HAP interface</h3>
<p>Based on user configuration, DCVS module in DSP can adjust the core and bus clock frequencies based on core and bus usage metrics captured by SysMon. The existing DCVS v2 algorithm via <a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a> (type: HAP_power_set_DCVS_v2) exposes multiple DCVS options for diversified clients and a simplified voltage corner based voting scheme. But along with existing features, DCVS v3 provides separate voltage corner voting option to user for core and bus clock and also option to disable all low power modes without explicit sleep latency vote need. In scenarios where user is ok for same voltage corner voting for core and bus clock then they can still use DCVS v2. Also, in DCVS v3 user can vote for individual field/multiple fields based on his requirement. On supported targets (SM8250 and latest), these new DCVS options and voting scheme are exposed to clients via <a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a> (type: HAP_power_set_DCVS_v3). Also, added wrapper functions built around same <a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a> (type: HAP_power_set_DCVS_v3) to help user to select and vote for individual functionality in DCVS v3 without bothering about DCVS v3 structure and related details. This document captures information on these new DCVS v3 features and ways to use them.</p>
<h4>HAP API Support</h4>
<p>The HAP_power_set API is enhanced to support the new user options with DCVS v3 with the new request type HAP_power_set_DCVS_v3 with <a class="el" href="structHAP__power__dcvs__v3__payload.html">HAP_power_dcvs_v3_payload</a>.</p>
<table class="doxtable">
<tr>
<th>API </th><td colspan="3">HAP_power_set (void* context, HAP_power_request_t* request) </td></tr>
<tr>
<th>context </th><td colspan="3">Explained <a href="#usage">here</a>. Votes across all contexts will be aggregated accordingly. </td></tr>
<tr>
<th rowspan="14">request </th><td>type </td><td>HAP_power_set_DCVS_v3 </td><td>This new request type allows user to request via the new dcvs_v3 request structure </td></tr>
<tr>
<td rowspan="13">dcvs_v3 </td><td>set_dcvs_enable </td><td>DCVS participation validity flag. If FALSE then the dcvs_enable and dcvs_option fields will be ignored. </td></tr>
<tr>
<td>dcvs_enable </td><td>DCVS participation flag. Vaild when the set_dcvs_enable is set to TRUE. </td></tr>
<tr>
<td>dcvs_option </td><td>These options instruct DCVS algorithm to use a pre-defined set of thresholds and operation logic based on the selected option. </td></tr>
<tr>
<td>set_latency </td><td>Latency vote validity flag. If FALSE then the latency field will be ignored. </td></tr>
<tr>
<td>latency </td><td>sleep latency vote in micro seconds. Valid when the set_latency flag is set to TRUE </td></tr>
<tr>
<td>set_core_params </td><td>Core clock params validity flag. If FALSE then the core_params field be ignored. </td></tr>
<tr>
<td>core_params </td><td>Core clock params structure with flexibility to set upper and lower core clock DCVS thresholds and also vote for core clock using a voltage corner. Valid when set_core_params is set to TRUE. </td></tr>
<tr>
<td>set_bus_params </td><td>Bus clock params validity flag. If FALSE then the bus_params field will be ignored. </td></tr>
<tr>
<td>bus_params </td><td>Bus clock params structure with flexibility to set upper and lower bus clock DCVS thresholds and also vote for bus clock using a voltage corner. Valid when set_bus_params is set to TRUE. </td></tr>
<tr>
<td>set_dcvs_v3_params </td><td>Validity flag for reserved DCVS params. If FALSE then the dcvs_v3_params field will be ignored. </td></tr>
<tr>
<td>dcvs_v3_params </td><td>Reserved DCVS params </td></tr>
<tr>
<td>set_sleep_disable </td><td>Sleep param validity flag. If FALSE then the sleep_disable field will be ignored. </td></tr>
<tr>
<td>sleep_disable </td><td>To disable/enable sleep(LPM modes). Valid when set_sleep_disable is set to TRUE. </td></tr>
</table>
<h4>Wrapper APIs</h4>
<p>There are wrapper functions built around same <a class="el" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set()</a>(type: HAP_power_set_DCVS_v3) to help user to select and vote for individual functionality in DCVS v3 without bothering about DCVS v3 structure and related details. Below section provides these APIs details.</p>
<ul>
<li><a class="el" href="group__HAP__power__functions.html#ga88a22b9a5d5526ba4a2000985c239f76">HAP_power_set_dcvs_v3_init()</a></li>
<li><a class="el" href="group__HAP__power__functions.html#gaffa18abe0490c982e19c43609989da71">HAP_power_set_dcvs_option()</a></li>
<li><a class="el" href="group__HAP__power__functions.html#gad101330a9cf3d2661ed59298950fd04b">HAP_power_set_sleep_latency()</a></li>
<li><a class="el" href="group__HAP__power__functions.html#gab183d6d11d4bd25dd633c225652dfdb4">HAP_power_set_core_corner()</a></li>
<li><a class="el" href="group__HAP__power__functions.html#ga79eb50fb3d79fccf7e6abce0f38280f8">HAP_power_set_bus_corner()</a></li>
<li><a class="el" href="group__HAP__power__functions.html#gae79560ad4e06bfd378fc8ca8eb9aab8f">HAP_power_set_sleep_mode()</a></li>
</ul>
<h4>DCVS Enable</h4>
<p>'dcvs_enable' parameter of dcvs_v2 structure enables user to vote for DCVS participation. </p><table class="doxtable">
<tr>
<th>Value </th><th>Description </th></tr>
<tr>
<td>TRUE </td><td>Enable DSP DCVS (if not already enabled). Using dcvs_option, based on the application demand, user can choose a particular option to guide DSP DCVS logic </td></tr>
<tr>
<td>FALSE </td><td>Don't enable DSP DCVS. Valid only when the client requesting is the only one actively voting for clocks or is one among the clients voting for this same option. </td></tr>
</table>
<p>'set_dcvs_enable' and 'dcvs_enable parameters' of dcvs_v3 structure enables user to vote for DCVS participation. </p><table class="doxtable">
<tr>
<th rowspan="2">set_dcvs_enable </th><td>FALSE </td><td>No DCVS request from the client, dcvs_enable and dcvs_option fields will be ignored. </td></tr>
<tr>
<td>TRUE </td><td>Client request for DCVS is valid and desired DCVS participation is provided in dcvs_enable field. </td></tr>
<tr>
<th rowspan="2">dcvs_enable </th><td>TRUE </td><td>Enable DSP DCVS (if not already enabled). Using dcvs_option, based on the application demand, user can choose a particular option to guide DSP DCVS logic. </td></tr>
<tr>
<td>FALSE </td><td>Don't enable DSP DCVS. Valid only when the client requesting is the only one actively voting for clocks or is one among the clients voting for this same option. </td></tr>
</table>
<p>When a DCVS participating client is active, DCVS logic would be enabled, but the aggregated clients vote requesting for DCVS disable will be considered as a FLOOR request in DCVS logic i.e, DCVS would't lower the clocks below the aggregated value.</p>
<h4>DCVS Options</h4>
<p>'dcvs_option' parameter of dcvs_v2 structure enables user to request for a particular DCVS mode when 'dcvs_enable' option is set to TRUE.</p>
<p>'dcvs_option' parameter of dcvs_v3 structure enables user to request for a particular DCVS mode when 'set_dcvs_enable' and 'dcvs_enable' both are set to TRUE.</p>
<p>Following table captures the gist of the available DCVS modes.</p>
<table class="doxtable">
<tr>
<th>Value </th><th>Description </th></tr>
<tr>
<td>HAP_DCVS_V2_ADJUST_UP_DOWN </td><td><p class="starttd">Legacy option: For clients voting via HAP_power_set_mips_bw request type. This mode allows DCVS to both increase and decrease core/bus clock speeds based on need. DCVS selects thresholds corresponding to a balanced mode (legacy) of operation with respect to power and performance.</p>
<p>min_corner and max_corner votes via dcvs_params are used as lower and</p>
<p>upper limit guidelines in DCVS.</p>
<p>NOTE: If client votes via target_corner under dcvs_params of this structure, both HAP_DCVS_V2_ADJUST_ONLY_UP and HAP_DCVS_V2_ADJUST_UP_DOWN modes are identical. min_corner and max_corner votes are used as lower and upper limit guidelines in DCVS while using balanced mode (legacy) thresholds.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>HAP_DCVS_V2_ADJUST_ONLY_UP </td><td><p class="starttd">Legacy option: For clients voting via HAP_power_set_mips_bw request type.</p>
<p>This mode restricts DCVS from lowering the clock below the values requested via HAP_power_set_mips_bw request. DCVS can only increase the clock above the requested levels. DCVS selects thresholds corresponding to a balanced mode(legacy) of operation with respect to power and performance. max_corner vote via dcvs_params is used as upper limit guideline in DCVS.</p>
<p>NOTE: If client votes via target_corner under dcvs_params of this structure, both HAP_DCVS_V2_ADJUST_ONLY_UP and HAP_DCVS_V2_ADJUST_UP_DOWN modes are identical. min_corner and max_corner votes are used as lower and upper limit guidelines in DCVS while using balanced mode (legacy) thresholds.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>HAP_DCVS_V2_POWER_SAVER_MODE </td><td><p class="starttd">New option:</p>
<p>Default for all clients participating in DCVS. DCVS can both increase and decrease the core/bus clock speeds while min_corner and max_corner votes are used as lower and upper limit guidelines. DCVS selects thresholds corresponding to power saving model. This mode is meant for applications where saving power is of higher priority than achieving fastest performance. Performance may be slower in this mode than in HAP_DCVS_V2_PERFORMANCE_MODE or the legacy modes i.e, HAP_DCVS_V2_ADJUST_ONLY_UP HAP_DCVS_V2_ADJUST_UP_DOWN</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>HAP_DCVS_V2_POWER_SAVER_AGGRESSIVE_MODE </td><td><p class="starttd">New option:</p>
<p>DCVS can both increase and decrease the core/bus clock speeds while min_corner and max_corner votes are used as lower and upper limit guidelines. DCVS selects thresholds corresponding to a power saving model. Further, the DCVS monitoring durations in lowering the clocks is decreased for a faster ramp down and hence greater power saving compared to the power saver mode. This mode is meant for applications where saving power is of higher priority than achieving fastest performance. Performance may be slower in this mode than in HAP_DCVS_V2_PERFORMANCE_MODE HAP_DCVS_V2_POWER_SAVER_MODE or the legacy modes i.e, HAP_DCVS_V2_ADJUST_ONLY_UP HAP_DCVS_V2_ADJUST_UP_DOWN</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>HAP_DCVS_V2_PERFORMANCE_MODE </td><td><p class="starttd">New option:</p>
<p>DCVS can both increase and decrease the core/bus clock speeds while min_corner and max_corner votes are used as lower and upper limit guidelines. DCVS selects a set of aggressive thresholds in terms of performance. DCVS can quickly bump up the clocks in this mode assisting higher performance at the cost of power.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>HAP_DCVS_V2_DUTY_CYCLE_MODE </td><td>This mode is for periodic use cases. DCVS detects the periodicity and sets/removes the core and bus clock votes for active/idle durations respectively. This mode helps save power significantly by reducing idle leakage current while keeping the performance intact. Compared to Applications setting/removing clock votes for each active frame to save the power, the DCVS duty cycle mode provides better performance and more power savings, as in this mode, the voting is done upfront by DCVS just before active duration start based on periodicity prediction. </td></tr>
</table>
<p>In cases where multiple clients have registered different DCVS options, following table depicts the DCVS policy aggregation logic. </p><table class="doxtable">
<tr>
<th>PERFORMANCE (Yes / No) </th><th>POWER SAVER (Yes / No) </th><th>POWER SAVER AGGRESSIVE (Yes / No) </th><th>BALANCED (UP ONLY/UP AND DOWN clients) (Yes / No) </th><th>Final DCVS thresholds </th></tr>
<tr>
<td>Y </td><td>Y /N </td><td>Y /N </td><td>Y /N </td><td>PERFORMANCE </td></tr>
<tr>
<td>N </td><td>Y </td><td>Y /N </td><td>Y /N </td><td>POWER SAVER </td></tr>
<tr>
<td>N </td><td>N </td><td>Y </td><td>Y </td><td>POWER SAVER </td></tr>
</table>
<h4>DCVS Duty Cycle</h4>
<p>DCVS Duty Cycle mode is for periodic use cases. DCVS detects the periodicity and sets/removes the core and bus clock votes as per active/idle duration. Hence this mode helps in saving the power to great extent by reducing idle leakage current while keeping the performance intact.</p>
<p>Below example illustrates DCVS Duty Cycle working. Here application has 30FPS requirement and voted for TURBO_PLUS core and bus clock.</p>
<p>For this application run, Core/Bus clock and related DSP metrics with and without DCVS Duty Cycle are shown below. In no duty cycle case, core and bus clock is at TURBO_PLUS throughout the application run. But in DCVS Duty Cycle case, DCVS detects the periodicity in use case and sets core and bus clock to TURBO_PLUS in activity time and then sets to lower clock LOW SVS during idle time for each frame.</p>
<div class="image">
<img src="../../images/DCVS_CoreClock_DutyCycle.png"  alt="screenshot"/>
</div>
<div class="image">
<img src="../../images/DCVS_BusClock_DutyCycle.png"  alt="screenshot"/>
</div>
<p>Hence in this way, DCVS Duty Cycle saves power to great extent by reducing idle leakage current and keep application performance intact. With increasing processing speed on DSP processor, active time for applications will reduce further and will result in more power saving with DCVS Duty cycle mode due to increased idle time.</p>
<h4>Sleep latency</h4>
<p>'set_latency' and 'latency' parameters of structure dcvs_v2 can be used to request for a sleep latency in micro seconds.</p>
<table class="doxtable">
<tr>
<th rowspan="2">set_latency </th><td>FALSE </td><td>No sleep latency request from the client. If FALSE then default sleep latency vote of 65535 micro seconds will be considered. </td></tr>
<tr>
<td>TRUE </td><td>Client request for a sleep latency is valid and desired latency is provided in latency field. </td></tr>
<tr>
<th>latency </th><td colspan="2">Sleep latency request in micro-seconds. </td></tr>
</table>
<p>Similarly 'set_latency' and 'latency' parameters of structure dcvs_v3 can be used to request for a sleep latency in micro seconds.</p>
<table class="doxtable">
<tr>
<th rowspan="2">set_latency </th><td>FALSE </td><td>No sleep latency request from the client. If FALSE then the latency field will be ignored. </td></tr>
<tr>
<td>TRUE </td><td>Client request for a sleep latency is valid and desired latency is provided in latency field. </td></tr>
<tr>
<th>latency </th><td colspan="2">Sleep latency request in micro-seconds. </td></tr>
</table>
<p>NOTE: HAP_power_set provides below possible ways for voting for sleep latency:</p>
<ol type="1">
<li>via HAP_power_set_mips_bw request type: <div class="fragment"><div class="line"><span class="comment">/* For sleep latency */</span></div><div class="line">mips_bw.set_latency = TRUE;</div><div class="line">mips_bw.latency = &lt;Sleep latency tolerance in micro seconds&gt;</div></div><!-- fragment --></li>
<li>via HAP_power_set_DCVS_v2 request type: <div class="fragment"><div class="line"><span class="comment">/* For sleep latency */</span></div><div class="line">dcvs_v2.set_latency = TRUE;</div><div class="line">dcvs_v2.latency = &lt;Sleep latency tolerance in micro seconds&gt;</div></div><!-- fragment --> Or via HAP_power_set_DCVS_v3 request type: <div class="fragment"><div class="line"><span class="comment">/* For sleep latency */</span></div><div class="line">dcvs_v3.set_latency = TRUE;</div><div class="line">dcvs_v3.latency = &lt;Sleep latency tolerance in micro second&gt;</div></div><!-- fragment --></li>
</ol>
<p>Clients should use only 1 of the above methods to vote for latency i.e, either via mips_bw or via dcvs_v2/dcvs_v3 but not both. Voting via dcvs_v2/dcvs_v3 does NOT cancel any previous vote done via mips_bw and vice versa.</p>
<p>latency value can be set to a minimum of 10 micro-second. The Application should vote for a latency that is tolerable. For latency critical applications, the latency can be set to its minimum value of 10 micro-second.</p>
<h4>DCVS params</h4>
<p>set_dcvs_params and dcvs_params parameters of dcvs_v2 can be used to update DCVS thresholds and target corner vote. set_core_params and core_params parameters of dcvs_v3 can be used to update DCVS thresholds and target corner vote for core clock. Similarly set_bus_params and bus_params parameters for bus clock. This structure is valid irrespective of chosen dcvs_enable and dcvs_option values. Client can request for a target_corner even when the dcvs_enable option is set to FALSE.</p>
<p>When set_dcvs_params/set_core_params/set_bus_params is TRUE, target_corner, min_corner and max_corner parameters of dcvs_params/core_params/bus_params can take one of the value in <a class="el" href="group__HAP__power__enums.html#ga505c8af5958573097eed284840397f5e">HAP_dcvs_voltage_corner_t</a>;</p>
<table class="doxtable">
<tr>
<th>HAP_dcvs_voltage_corner_t </th><th>Description </th></tr>
<tr>
<td>HAP_DCVS_VCORNER_DISABLE </td><td>No specific corner request (No Vote) </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_SVS2 </td><td>SVS2 / LOW SVS corner Note: On targets that don't support this voltage corner, this option will be interpreted as HAP_DCVS_VCORNER_SVS </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_SVS </td><td>SVS corner </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_SVSPLUS </td><td>SVS Plus corner Note: On targets that don't support this voltage corner, this option will be interpreted as HAP_DCVS_VCORNER_SVS </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_NOM </td><td>NOMINAL corner </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_NOMPLUS </td><td>NOMINAL Plus corner Note: On targets that don't support this voltage corner, this option will be interpreted as HAP_DCVS_VCORNER_NOM </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_TURBO </td><td>TURBO corner </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_TURBO_PLUS </td><td>TURBO Plus corner Note: Valid only on SM8150, maps to TURBO frequency for SM6150, QCS405. Returns error on earlier targets (SDM845, SDM710 and prior ones) </td></tr>
<tr>
<td>HAP_DCVS_VCORNER_MAX </td><td>MAX possible corner defined for maximum performance. Note: Supported only on SM8150, SM6150, QCS405 and later chipsets. Returns error on earlier targets (SDM845, SDM710 and prior ones) </td></tr>
</table>
<p><br />
 </p><table class="doxtable">
<tr>
<th rowspan="6">dcvs_params/core_params/bus_params </th><td>target_corner </td><td><p class="starttd">Type: HAP_dcvs_voltage_corner_t. Alternative to HAP_power_set_mips_bw MIPS and Bandwidth request. HAP_power_set provides 2 possible ways for voting for sleep latency and core/bus clocks.</p><ol type="1">
<li>via HAP_power_set_mips_bw request type: <div class="fragment"><div class="line"><span class="comment">/* For core clock */</span></div><div class="line">mips_bw.set_mips = TRUE;</div><div class="line">mips_bw.mipsPerThread = &lt;MIPS per thread request&gt;</div><div class="line">mips_bw.mipsTotal = &lt;Total MIPS request&gt;</div><div class="line"><span class="comment">/* For bus clock */</span></div><div class="line">mips_bw.set_bus_bw = TRUE;</div><div class="line">mips_bw.bwBytePerSec = &lt;bandwidth request in bytes per second (Instantaneous)&gt;</div><div class="line">mips_bw.busbwUsagePercentage = &lt;Usage percentage (Average)&gt;</div><div class="line"><span class="comment">/* For sleep latency */</span></div><div class="line">mips_bw.set_latency = TRUE;</div><div class="line">mips_bw.latency = &lt;Sleep latency in micro seconds&gt;</div></div><!-- fragment --></li>
<li>via HAP_power_set_DCVS_v2 request type: <div class="fragment"><div class="line"><span class="comment">/* For core and bus clock */</span></div><div class="line">dcvs_v2.set_dcvs_params = TRUE;</div><div class="line">dcvs_v2.dcvs_params.target_corner = &lt;Desired vote in terms of voltage corner <span class="keywordflow">for</span> core, bus clocks&gt;</div><div class="line"><span class="comment">/* For sleep latency */</span></div><div class="line">dcvs_v2.set_latency = TRUE;</div><div class="line">dcvs_v2.latency = &lt;Sleep latency in micro seconds&gt;</div></div><!-- fragment --> or</li>
<li>via HAP_power_set_DCVS_v3 request type: <div class="fragment"><div class="line"><span class="comment">/* For core clock */</span></div><div class="line">dcvs_v3.set_core_params = TRUE;</div><div class="line">dcvs_v3.core_params.target_corner = &lt;Desired vote in terms of</div><div class="line">voltage corner <span class="keywordflow">for</span> core clock&gt;</div><div class="line"><span class="comment">/* For bus clock */</span></div><div class="line">dcvs_v3.set_bus_params = TRUE;</div><div class="line">dcvs_v3.bus_params.target_corner = &lt;Desired vote in terms of</div><div class="line">voltage corner <span class="keywordflow">for</span> bus clock&gt;</div><div class="line"><span class="comment">/* For sleep latency */</span></div><div class="line">dcvs_v3.set_latency = TRUE;</div><div class="line">dcvs_v3.latency = &lt;Sleep latency tolerance in micro seconds&gt;</div></div><!-- fragment --> Client can request core and bus clock to run at at a particular voltage corner instead of providing MIPS and Bandwidth (bytes per second) requests. DCVS will convert the requested voltage corner value to appropriate core clock and bus clock votes and forwards the request to the power manager on client's behalf. Clients should use only 1 of the above methods to vote i.e, either via mips_bw or via dcvs_v2/dcvs_v3 but not both. Voting via dcvs_v2/dcvs_v3 does NOT cancel any previous vote done via mips_bw and vice versa. If one would like to switch between these 2 methods, cancel any previous vote done via the other method before requesting.</li>
</ol>
<p>When target_corner = HAP_DCVS_VCORNER_DISABLE (No vote), DSP DCVS doesn't request for any core or bus clocks at the time of API call and it's client's responsibility to vote for core and bus clocks using HAP_power_set_mips_bw type request type.</p>
<p>If enabled &gt; HAP_DCVS_VCORNER_DISABLE, DSP DCVS logic will pick the highest available frequency plan for both core and bus clocks at the given voltage corner and requests for these clock frequencies synchronously in the API context on client's behalf. When the HAP_power_set API returns with success, core and bus clock frequencies would be set by DSP DCVS on a valid target_corner request.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>min_corner </td><td><p class="starttd">Type: HAP_dcvs_voltage_corner_t.</p>
<p>If disabled, min_corner == HAP_DCVS_VCORNER_DISABLE, the lower threshold/minimum value that DCVS can correct the clock will remain unchanged. If enabled &gt; HAP_DCVS_VCORNER_DISABLE, DSP DCVS picks the lowest core clock frequency at the given voltage corner and uses it as the lower threshold/minimum value that DCVS can correct the clock to, irrespective of the dcvs_option selected.</p>
<p>Client can vote for a min_corner irrespective of a target_corner i.e, client can have target_corner = HAP_DCVS_VCORNER_DISABLE (no vote) but can set a minimum corner threshold for DCVS.</p>
<p>min_corner should always be less than or equal to target_corner and max_corner unless they are disabled HAP_DCVS_VCORNER_DISABLE.</p>
<p>For clients requesting dcvs_enable as FALSE and using target_corner, min_corner should be equal to target_corner.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>max_corner </td><td><p class="starttd">Type: HAP_dcvs_voltage_corner_t.</p>
<p>If disabled, max_corner == HAP_DCVS_VCORNER_DISABLE, the upper threshold/maximum value that DCVS can correct the clock will remain unchanged. Typically, that would be HAP_DCVS_VCORNER_MAX in this case. If enabled &gt; HAP_DCVS_VCORNER_DISABLE, DSP DCVS picks the highest core and bus clock frequencies at the given voltage corner and uses it as the upper threshold/maximum value that DCVS can correct the clocks to, irrespective of the dcvs_option selected.</p>
<p>DSP DCVS logic overrides the max_corner vote from a client to MAX in presence of a concurrency. Concurrency is defined as a scenario where 2 or more FastRPC dynamic loaded clients are active or active Audio/Voice sessions with MPPS load greater than a pre-defined threshold.</p>
<p>Client can vote for a max_corner irrespective of a target_corner vote i.e,client can have target_corner = HAP_DCVS_VCORNER_DISABLE(no vote) but can set a maximum corner threshold for DCVS using this param.</p>
<p>max_corner should always be greater than or equal to target_corner and min_corner votes, or, should be disabled HAP_DCVS_VCORNER_DISABLE.</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>param1 </td><td><p class="starttd">Type: HAP_dcvs_voltage_corner_t.</p>
<p>NOTE: Set this option to HAP_DCVS_VCORNER_DISABLE unless required.</p>
<p>This parameter allows user to set CPU L3 clock frequency to the requested corner. Valid only on CDSP subsystem in targets with CPU L3 cache and IO-coherency enabled (SDM845, SDM710, SM8150...), ignored elsewhere. On CDSP, based on the requested target_corner, CPU L3 clock vote from CDSP is set to a balanced level (with minimal power impact) to start with and DCVS (if enabled) increases the vote based on need to attain higher performance. This option is useful to peg CPU L3 clock at a higher level (at the cost of higher power) than that of the default balanced vote and that of the DCVS algorithm votes. This option is for advanced users and should be configured to default (HAP_DCVS_VCORNER_DISABLE) unless there is a need to explicitly set CPU L3 clock frequency based on performance and power analysis/characterization</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>param2 </td><td>Reserved. </td></tr>
<tr>
<td>param3 </td><td>Reserved. </td></tr>
</table>
<h4>DCVS vote aggregation logic in case of concurrency</h4>
<p>Following logic explains the aggregation logic for min and target corner votes when there are multiple requesting clients: </p><div class="fragment"><div class="line">DCVS min_corner vote = MAX (min_corner vote client 1, client 2, ...)</div><div class="line">DCVS target_corner vote = MAX (target_corner vote client 1, client 2, ...)</div></div><!-- fragment --><p> The following scenarios are treated as a concurrency in DCVS vote aggregation logic where DCVS max corner vote is set to TURBO by DCVS:</p><ul>
<li>More than 1 active HAP client with or without active Audio/Voice clients.</li>
<li>One active HAP client and active Audio/Voice clients with MPPS load greater than a pre-defined threshold. <div class="fragment"><div class="line">DCVS max_corner vote = HAP_DCVS_VCORNER_MAX</div></div><!-- fragment --></li>
</ul>
<p>Note that DCVS overrides client's MAX corner vote to MAX to accommodate any concurrency requirement. DCVS MAX vote of MAX doesn't necessarily mean that DCVS will push the vote to MAX corner; MAX corner vote just sets the upper threshold for DCVS vote logic. DCVS will only bump up the clocks on need basis based on selected DCVS option.</p>
<h4>Sleep Disable</h4>
<p>'set_sleep_disable' and 'sleep_disable parameters' of dcvs_v3 structure enables user to disable sleep (all LPM modes) in DSP.</p>
<table class="doxtable">
<tr>
<th rowspan="2">set_sleep_disable </th><td>FALSE </td><td>No sleep mode request from the client. If FALSE then the sleep_disable field will be ignored. </td></tr>
<tr>
<td>TRUE </td><td>Client request for sleep mode is valid and desired option is provided in sleep_disable field. </td></tr>
<tr>
<th rowspan="2">sleep_disable </th><td>TRUE </td><td>To disable sleep (all LPM modes) in DSP. </td></tr>
<tr>
<td>FALSE </td><td>To re-enable sleep in DSP. </td></tr>
</table>
<h4>Illustrations (DCVS_V2)</h4>
<p>NOTE: For working example, refer <code>$HEXAGON_SDK_ROOT\examples\common\benchmark_v65</code> application; See benchmark_setClocks() in src_dsp\benchmark_imp.c</p>
<ol type="1">
<li>Requirement: Enable DCVS in PERFORMANCE mode, set sleep latency to 1000 micro-seconds, vote NOM in Target with SVS as Min and TURBO as Max. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a6f1ae78ec168c0e33fd0a8a5e3c59dde">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba0a2b18cb76401d0f85983539fad4047e">HAP_DCVS_V2_PERFORMANCE_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a3e0469413c326dafb1c9e990bb9df615">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a3089a1d2001b3ef318fbf129b7c6ced2">latency</a> = 1000;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a694bdd7bb3d0fb9f5a2bcffb319cdb6e">set_dcvs_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a8335d8b40c6b02ee20b364864aa8aeba">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a1ef0cba4efc2ed48d56e2fa5a60159fd">max_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a0778ad398c0b9a08762aa10970f19764">target_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the vote keeping DCVS enabled.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Remove all votes.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a6f1ae78ec168c0e33fd0a8a5e3c59dde">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba0a2b18cb76401d0f85983539fad4047e">HAP_DCVS_V2_PERFORMANCE_MODE</a>; <span class="comment">//Enable DCVS</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Disable DCVS; do NOT vote for any corners/latency <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = FALSE;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Enable DCVS in Power saver mode. Do NOT vote for any target corner/latency, but set MIN and MAX thresholds to DCVS to SVS and TURBO respectively. Clock voting will be done via HAP_power_set_mips_bw request. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure with dcvs_v2 request*/</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a6f1ae78ec168c0e33fd0a8a5e3c59dde">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba9522fc6255c15945f3a481e404e68dfa">HAP_DCVS_V2_POWER_SAVER_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a694bdd7bb3d0fb9f5a2bcffb319cdb6e">set_dcvs_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a8335d8b40c6b02ee20b364864aa8aeba">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a1ef0cba4efc2ed48d56e2fa5a60159fd">max_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a0778ad398c0b9a08762aa10970f19764">target_corner</a> = HAP_DCVS_VCORNER_DISABLE; <span class="comment">//no vote</span></div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line"><span class="comment">/* Populate request structure with mips_bw request */</span></div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a2a508dfbee34f8d93e7549d7e1d492a5">HAP_power_set_mips_bw</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a7f389e18621a603cc66694f507000661">set_mips</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#abed5617c101315cbc9c14be164fb62de">mipsPerThread</a> = 150;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#ae51e908b15ca6af40fb2f3e3fe17d7f5">mipsTotal</a> = 600;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a45ea07ccf5c014fe6fdddd2f4313b1ab">set_bus_bw</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.bwBytesPerSec = 10*1000*1000;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#ad282ee980488c3bbd9e9fba1a4df6c30">busbwUsagePercentage</a> = 50;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a62e2cbc60ac218b44aacad9fa375f690">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a293baca089d749844844f386d49b43cd">latency</a> = 1000;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request); <span class="comment">// Core and bus clocks will be set by this request.</span></div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the dcvs_v2 vote keeping DCVS enabled.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Remove all votes.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a6f1ae78ec168c0e33fd0a8a5e3c59dde">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba9522fc6255c15945f3a481e404e68dfa">HAP_DCVS_V2_POWER_SAVER_MODE</a>; <span class="comment">//Enable DCVS</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line"><span class="comment">//To remove the mips_bw vote</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Remove all votes</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a2a508dfbee34f8d93e7549d7e1d492a5">HAP_power_set_mips_bw</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a7f389e18621a603cc66694f507000661">set_mips</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a45ea07ccf5c014fe6fdddd2f4313b1ab">set_bus_bw</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a62e2cbc60ac218b44aacad9fa375f690">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a293baca089d749844844f386d49b43cd">latency</a> = 65535;</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Enable DCVS in DUTY CYCLE mode, vote TURBO in Target with SVS as Min. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a6f1ae78ec168c0e33fd0a8a5e3c59dde">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffbac83781a544a95701221ba4d60f22154e">HAP_DCVS_V2_DUTY_CYCLE_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a3e0469413c326dafb1c9e990bb9df615">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a3089a1d2001b3ef318fbf129b7c6ced2">latency</a> = 1000;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a694bdd7bb3d0fb9f5a2bcffb319cdb6e">set_dcvs_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a8335d8b40c6b02ee20b364864aa8aeba">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a1ef0cba4efc2ed48d56e2fa5a60159fd">max_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a2c543c18051655153786db46180e813c">dcvs_params</a>.<a class="code" href="structHAP__dcvs__params__t.html#a0778ad398c0b9a08762aa10970f19764">target_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the vote keeping DCVS enabled.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Remove all votes.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a391fd8daac4f79b45c7cda000d65737d">HAP_power_set_DCVS_v2</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a1363db29710aeeaad9d34b7385fe8fbb">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#aefa1caecf2ec1583e2e366efe921fe24">dcvs_v2</a>.<a class="code" href="structHAP__power__dcvs__v2__payload.html#a6f1ae78ec168c0e33fd0a8a5e3c59dde">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba9522fc6255c15945f3a481e404e68dfa">HAP_DCVS_V2_POWER_SAVER_MODE</a>; <span class="comment">//Enable DCVS</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
</ol>
<h4>Illustrations (DCVS_V3)</h4>
<ol type="1">
<li>Requirement: Enable DCVS in POWER SAVER mode, set sleep latency to 1000 micro-seconds, vote NOM in Target with SVS as Min and TURBO as Max for core clock, vote TURBO in Target with NOM as Min and TURBO PLUS as Max for bus clock. Later change bus clock vote as SVS_PLUS in Target with SVS as Min and NOM as Max. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a5ac5f5adc3222b89eec9396e5a49bb1b">set_dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a1235ddcf75f6d5f42a1a9ed898eaad8d">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a76e2c875d070a96eba2ac3871061e640">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba9522fc6255c15945f3a481e404e68dfa">HAP_DCVS_V2_POWER_SAVER_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a890f39f213d35ee3d74ceb6374e8f7a2">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aade1c833a8fcce038ad5383f4969a34b">latency</a> = 1000;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#afe269475b96d158f13ed021cba41bfc5">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#a86fe09133cfd0f6acac57d04edef30c0">max_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#a9fd0a09a06837606c2d1095f0a356ab9">target_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a88e27d5d878fff57a2788c80f824030a">set_bus_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#ada54d5513724da811a047c4fe3732dfd">min_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#a4f87652ce9c07d835ec33acba0ac6372">max_corner</a> = HAP_DCVS_VCORNER_TURBO_PLUS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#ad75767c738bd2ac8fb9d995579931fbe">target_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block 1</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To update bus clock votes while keeping core clock and other parameters of dcvs_v3 request intact.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a88e27d5d878fff57a2788c80f824030a">set_bus_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#ada54d5513724da811a047c4fe3732dfd">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#a4f87652ce9c07d835ec33acba0ac6372">max_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#ad75767c738bd2ac8fb9d995579931fbe">target_corner</a> = HAP_DCVS_VCORNER_SVSPLUS;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block 2</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the vote keeping DCVS enabled.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a890f39f213d35ee3d74ceb6374e8f7a2">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aade1c833a8fcce038ad5383f4969a34b">latency</a> = 65535;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a88e27d5d878fff57a2788c80f824030a">set_bus_params</a> = TRUE;</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Enable DCVS in PERFORMANCE mode, vote TURBO in Target with NOM as Min and TURBO PLUS as Max for core clock, do NOT vote for latency and bus clock. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a5ac5f5adc3222b89eec9396e5a49bb1b">set_dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a1235ddcf75f6d5f42a1a9ed898eaad8d">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a76e2c875d070a96eba2ac3871061e640">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba0a2b18cb76401d0f85983539fad4047e">HAP_DCVS_V2_PERFORMANCE_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#afe269475b96d158f13ed021cba41bfc5">min_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#a86fe09133cfd0f6acac57d04edef30c0">max_corner</a> = HAP_DCVS_VCORNER_TURBO_PLUS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#a9fd0a09a06837606c2d1095f0a356ab9">target_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the vote keeping DCVS enabled.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Disable DCVS; do NOT vote for any corners/latency. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a5ac5f5adc3222b89eec9396e5a49bb1b">set_dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a1235ddcf75f6d5f42a1a9ed898eaad8d">dcvs_enable</a> = FALSE;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = HAP_power_seti(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Disable sleep (all low power modes) and re-enable it after task completion. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ad9b12d20dfcb9aa6b86f4abc437a6508">set_sleep_disable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ade719bc377fb92c7b77fc829f697a3fd">sleep_disable</a> = TRUE;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To re-enable sleep.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ad9b12d20dfcb9aa6b86f4abc437a6508">set_sleep_disable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ade719bc377fb92c7b77fc829f697a3fd">sleep_disable</a> = FALSE;</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Enable DCVS in PERFORMANCE mode. Do NOT vote for any target corner/latency, but set MIN and MAX DCVS thresholds for core clock to NOM and TURBO respectively, set MIN and MAX DCVS thresholds for bus clock to SVS and NOM respectively. Clock voting will be done via HAP_power_set_mips_bw request. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure with dcvs_v3 request*/</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a5ac5f5adc3222b89eec9396e5a49bb1b">set_dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a1235ddcf75f6d5f42a1a9ed898eaad8d">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a76e2c875d070a96eba2ac3871061e640">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba0a2b18cb76401d0f85983539fad4047e">HAP_DCVS_V2_PERFORMANCE_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#afe269475b96d158f13ed021cba41bfc5">min_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#a86fe09133cfd0f6acac57d04edef30c0">max_corner</a> = HAP_DCVS_VCORNER_TURBO;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a88e27d5d878fff57a2788c80f824030a">set_bus_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#ada54d5513724da811a047c4fe3732dfd">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#a4f87652ce9c07d835ec33acba0ac6372">max_corner</a> = HAP_DCVS_VCORNER_NOM;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line"><span class="comment">/* Populate request structure with mips_bw request */</span></div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a2a508dfbee34f8d93e7549d7e1d492a5">HAP_power_set_mips_bw</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a7f389e18621a603cc66694f507000661">set_mips</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#abed5617c101315cbc9c14be164fb62de">mipsPerThread</a> = 150;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#ae51e908b15ca6af40fb2f3e3fe17d7f5">mipsTotal</a> = 600;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a45ea07ccf5c014fe6fdddd2f4313b1ab">set_bus_bw</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.bwBytesPerSec = 10*1000*1000;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#ad282ee980488c3bbd9e9fba1a4df6c30">busbwUsagePercentage</a> = 50;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a62e2cbc60ac218b44aacad9fa375f690">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a293baca089d749844844f386d49b43cd">latency</a> = 1000;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request); <span class="comment">// Core and bus clocks will be set by this request.</span></div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the dcvs_v3 vote keeping DCVS enabled.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a88e27d5d878fff57a2788c80f824030a">set_bus_params</a> = TRUE;</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line"><span class="comment">//To remove the mips_bw vote</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Remove all votes</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a2a508dfbee34f8d93e7549d7e1d492a5">HAP_power_set_mips_bw</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a7f389e18621a603cc66694f507000661">set_mips</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a45ea07ccf5c014fe6fdddd2f4313b1ab">set_bus_bw</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a62e2cbc60ac218b44aacad9fa375f690">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a3ee6200804b3b0cfc99c3f124f5ad5b3">mips_bw</a>.<a class="code" href="structHAP__power__mips__bw__payload.html#a293baca089d749844844f386d49b43cd">latency</a> = 65535;</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Use wrapper APIs to: Enable DCVS in POWER SAVER AGGRESSIVE mode, set sleep latency to 1000 micro-seconds, vote NOM in Target with SVS as Min and TURBO as Max for core clock, vote TURBO in Target with NOM as Min and TURBO PLUS as Max for bus clock. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line"><a class="code" href="group__HAP__power__functions.html#ga88a22b9a5d5526ba4a2000985c239f76">HAP_power_set_dcvs_v3_init</a>(&amp;request);</div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#gaffa18abe0490c982e19c43609989da71">HAP_power_set_dcvs_option</a>(NULL, TRUE, <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba78ed21f209935d764c5682dee3cf0a5b">HAP_DCVS_V2_POWER_SAVER_AGGRESSIVE_MODE</a>);</div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#gad101330a9cf3d2661ed59298950fd04b">HAP_power_set_sleep_latency</a>(NULL, 1000);</div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#gab183d6d11d4bd25dd633c225652dfdb4">HAP_power_set_core_corner</a>(NULL, HAP_DCVS_VCORNER_NOM, HAP_DCVS_VCORNER_SVS, HAP_DCVS_VCORNER_TURBO);</div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga79eb50fb3d79fccf7e6abce0f38280f8">HAP_power_set_bus_corner</a>(NULL, HAP_DCVS_VCORNER_TURBO, HAP_DCVS_VCORNER_NOM, HAP_DCVS_VCORNER_TURBO_PLUS);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the vote keeping default DCVS mode enabled.</span></div><div class="line"><a class="code" href="group__HAP__power__functions.html#ga88a22b9a5d5526ba4a2000985c239f76">HAP_power_set_dcvs_v3_init</a>(&amp;request);</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --></li>
<li>Requirement: Enable DCVS in DUTY CYCLE mode, vote TURBO_PLUS in Target with SVS as Min for core and bus clock. <div class="fragment"><div class="line"><span class="comment">//Vote</span></div><div class="line"></div><div class="line"><span class="comment">/* Populate request structure */</span></div><div class="line"><span class="keywordtype">int</span> retVal;</div><div class="line"><a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a> request;</div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>)); <span class="comment">//Important to clear the structure if only selected fields are updated.</span></div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a5ac5f5adc3222b89eec9396e5a49bb1b">set_dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a1235ddcf75f6d5f42a1a9ed898eaad8d">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a76e2c875d070a96eba2ac3871061e640">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffbac83781a544a95701221ba4d60f22154e">HAP_DCVS_V2_DUTY_CYCLE_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a890f39f213d35ee3d74ceb6374e8f7a2">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aade1c833a8fcce038ad5383f4969a34b">latency</a> = 1000;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#afe269475b96d158f13ed021cba41bfc5">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#a86fe09133cfd0f6acac57d04edef30c0">max_corner</a> = HAP_DCVS_VCORNER_TURBO_PLUS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aee5ca4548112c5f89f523e3a6119065d">core_params</a>.<a class="code" href="structHAP__core__params__t.html#a9fd0a09a06837606c2d1095f0a356ab9">target_corner</a> = HAP_DCVS_VCORNER_TURBO_PLUS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a88e27d5d878fff57a2788c80f824030a">set_bus_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#ada54d5513724da811a047c4fe3732dfd">min_corner</a> = HAP_DCVS_VCORNER_SVS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#a4f87652ce9c07d835ec33acba0ac6372">max_corner</a> = HAP_DCVS_VCORNER_TURBO_PLUS;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a16797d5a6a6f414946bf1ac163211096">bus_params</a>.<a class="code" href="structHAP__bus__params__t.html#ad75767c738bd2ac8fb9d995579931fbe">target_corner</a> = HAP_DCVS_VCORNER_TURBO_PLUS;</div><div class="line"><span class="comment">/* Call HAP_power_set API with the updated request structure */</span></div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div><div class="line">...</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> * Processing block</span></div><div class="line"><span class="comment"> */</span></div><div class="line">...</div><div class="line"><span class="comment">//To remove the vote keeping DCVS enabled.</span></div><div class="line">memset(&amp;request, 0, <span class="keyword">sizeof</span>(<a class="code" href="structHAP__power__request__t.html">HAP_power_request_t</a>));</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#a8dc18ce530467cbd2bc6c0e4a428479d">type</a> = <a class="code" href="group__HAP__power__enums.html#gga2fd3a43f8d4380da1ac1f06adc66ae95a7a5cde4a502349510ea1e804bf8b4147">HAP_power_set_DCVS_v3</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a5ac5f5adc3222b89eec9396e5a49bb1b">set_dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a1235ddcf75f6d5f42a1a9ed898eaad8d">dcvs_enable</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a76e2c875d070a96eba2ac3871061e640">dcvs_option</a> = <a class="code" href="group__HAP__power__enums.html#gga0b378c5692762c66290e9fc8db1e9ffba9522fc6255c15945f3a481e404e68dfa">HAP_DCVS_V2_POWER_SAVER_MODE</a>;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a890f39f213d35ee3d74ceb6374e8f7a2">set_latency</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#aade1c833a8fcce038ad5383f4969a34b">latency</a> = 65535;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#ab5500b7940758fb394b2a3ef1ae11b56">set_core_params</a> = TRUE;</div><div class="line">request.<a class="code" href="structHAP__power__request__t.html#ad826c42f9dccea6700c1f4e58a185375">dcvs_v3</a>.<a class="code" href="structHAP__power__dcvs__v3__payload.html#a88e27d5d878fff57a2788c80f824030a">set_bus_params</a> = TRUE;</div><div class="line"><span class="comment">/* ctx is an unique identifier, explained [here](#usage). */</span></div><div class="line">retVal = <a class="code" href="group__HAP__power__functions.html#ga5515366dfa64dccd060e9c5f2230ea82">HAP_power_set</a>(ctx, &amp;request);</div></div><!-- fragment --> </li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright  2020 Qualcomm Technologies Inc. All rights reserved.  Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
